<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin Dashboard - Sebaste Community Hospital</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Poppins:wght@500;600;900&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    } 
    
    body {
      font-family: 'Inter', sans-serif;
      margin: 0;
      padding: 0;
      min-height: 100vh;
      color: #333;
      background-color: #f0f5ff;
      overflow-x: hidden;
    }

    /* Background with white filter */
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: url('bg.jpg');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      opacity: 0.1;
      z-index: -1;
    }

    /* ===== NAVBAR STYLES ===== */
    .navbar-container {
      background-color: white;
      width: 100%;
      box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
      position: fixed;
      top: 0;
      left: 0;
      z-index: 1000;
    }

    .navbar-container header {
      height: 90px;
      padding: 0 40px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      max-width: 100%;
      margin: 0 auto;
      box-sizing: border-box;
    }

    .hospital-container {
      display: flex;
      align-items: center;
      gap: 15px;
      height: 100%;
    }

    .logo-container {
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100%;
      width: 60px;
      overflow: hidden;
    }

    .logo-container img {
      max-height: 79px;
      max-width: 100%;
      object-fit: contain;
    }

    .hospital-name {
      font-family: 'Poppins', sans-serif;
      font-size: 22px;
      font-weight: 600;
      color: #0B6A27;
      text-align: left;
      line-height: 1.2;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    .hospital-line {
      margin: 0;
      padding: 0;
    }

    /* User info in navbar */
    .user-info {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .user-avatar {
      width: 45px;
      height: 45px;
      border-radius: 50%;
      background-color: #0B6A27;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 600;
      font-size: 18px;
    }

    .user-name {
      font-weight: 600;
      font-size: 16px;
    }

    .admin-badge {
      background-color: #0B6A27;
      color: white;
      padding: 3px 8px;
      border-radius: 4px;
      font-size: 12px;
      margin-left: 5px;
    }

    /* ===== DASHBOARD LAYOUT ===== */
    .dashboard-container {
      display: flex;
      margin-top: 90px; /* Height of navbar */
      min-height: calc(100vh - 90px);
    }

    /* Sidebar styles */
    .sidebar {
      width: 280px;
      background-color: white;
      box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
      padding: 30px 0;
      position: fixed;
      top: 90px; /* Below navbar */
      left: 0;
      height: calc(100vh - 90px);
      overflow-y: auto;
      z-index: 100;
    }

    .sidebar-menu {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .sidebar-menu li {
      margin-bottom: 5px;
    }

    .sidebar-menu a {
      display: flex;
      align-items: center;
      padding: 15px 25px;
      text-decoration: none;
      color: #333;
      font-weight: 600;
      transition: all 0.3s ease;
      border-left: 4px solid transparent;
    }

    .sidebar-menu a:hover {
      background-color: rgba(11, 106, 39, 0.1);
    }

    .sidebar-menu a.active {
      background-color: rgba(11, 106, 39, 0.15);
      border-left: 4px solid #0B6A27;
      color: #0B6A27;
    }

    .sidebar-menu .icon {
      margin-right: 15px;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 24px;
      height: 24px;
    }

    .sidebar-menu .icon svg {
      width: 24px;
      height: 24px;
    }

    /* Main content area */
    .main-content {
      flex: 1;
      padding: 30px;
      margin-left: 280px; /* Width of sidebar */
    }

    .dashboard-header {
      margin-bottom: 30px;
    }

    .dashboard-header h1 {
      font-family: 'Poppins', sans-serif;
      font-size: 32px;
      font-weight: 700;
      color: #333;
      margin-bottom: 10px;
    }

    /* Admin specific styles */
    .admin-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }

    .admin-table th, .admin-table td {
      padding: 12px 15px;
      text-align: left;
      border-bottom: 1px solid #eee;
    }

    .admin-table th {
      background-color: #f5f5f5;
      font-weight: 600;
      color: #333;
    }

    .admin-table tr:hover {
      background-color: #f9f9f9;
    }

    .status-badge {
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: 600;
    }

    .status-pending {
      background-color: #fff3cd;
      color: #856404;
    }

    .status-approved {
      background-color: #d4edda;
      color: #155724;
    }

    .status-cancelled {
      background-color: #f8d7da;
      color: #721c24;
    }

    .status-completed {
      background-color: #d1ecf1;
      color: #0c5460;
    }

    .action-btn {
      padding: 6px 12px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      border: none;
      transition: all 0.3s ease;
      margin-right: 5px;
    }

    .approve-btn {
      background-color: rgba(25, 135, 84, 0.1);
      color: #198754;
    }

    .approve-btn:hover {
      background-color: rgba(25, 135, 84, 0.2);
    }

    .reject-btn {
      background-color: rgba(220, 53, 69, 0.1);
      color: #dc3545;
    }

    .reject-btn:hover {
      background-color: rgba(220, 53, 69, 0.2);
    }

    .view-btn {
      background-color: rgba(13, 110, 253, 0.1);
      color: #0d6efd;
    }

    .view-btn:hover {
      background-color: rgba(13, 110, 253, 0.2);
    }

    /* Form styles */
    .admin-form {
      background-color: white;
      border-radius: 15px;
      padding: 25px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
      margin-bottom: 30px;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: #333;
    }

    .form-control {
      width: 100%;
      padding: 10px 15px;
      border: 1px solid #ddd;
      border-radius: 5px;
      font-size: 16px;
      transition: border-color 0.3s ease;
    }

    .form-control:focus {
      outline: none;
      border-color: #0B6A27;
    }

    .form-actions {
      display: flex;
      justify-content: flex-end;
      gap: 10px;
      margin-top: 20px;
    }

    .btn {
      padding: 10px 20px;
      border-radius: 5px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      border: none;
      transition: all 0.3s ease;
    }

    .btn-primary {
      background-color: #0B6A27;
      color: white;
    }

    .btn-primary:hover {
      background-color: #094e1d;
    }

    .btn-secondary {
      background-color: #6c757d;
      color: white;
    }

    .btn-secondary:hover {
      background-color: #5a6268;
    }

    /* Modal styles */
    .modal-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 2000;
      justify-content: center;
      align-items: center;
    }

    .modal-content {
      background-color: white;
      border-radius: 10px;
      padding: 30px;
      max-width: 600px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 1px solid #eee;
    }

    .modal-title {
      font-size: 24px;
      font-weight: 600;
      color: #333;
    }

    .close-btn {
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: #999;
    }

    .close-btn:hover {
      color: #333;
    }

    .detail-row {
      display: flex;
      margin-bottom: 15px;
    }

    .detail-label {
      font-weight: 600;
      width: 150px;
      color: #333;
    }

    .detail-value {
      flex: 1;
      color: #666;
    }

    /* Responsive adjustments */
    @media (max-width: 1024px) {
      .sidebar {
        width: 80px;
        padding: 20px 0;
      }

      .sidebar-menu a {
        padding: 15px;
        justify-content: center;
      }

      .sidebar-menu .icon {
        margin-right: 0;
      }

      .sidebar-menu .menu-text {
        display: none;
      }

      .main-content {
        margin-left: 80px;
      }
    }

    @media (max-width: 768px) {
      .navbar-container header {
        padding: 0 20px;
      }

      .user-name {
        display: none;
      }

      .admin-table {
        display: block;
        overflow-x: auto;
      }
    }

    @media (max-width: 576px) {
      .sidebar {
        width: 0;
        transform: translateX(-100%);
        transition: transform 0.3s ease;
      }

      .sidebar.active {
        width: 250px;
        transform: translateX(0);
      }

      .main-content {
        margin-left: 0;
        padding: 20px;
      }

      .mobile-menu-toggle {
        display: block;
      }
    }

    /* Additional styles for appointment system */
    .filter-card {
      background-color: white;
      border-radius: 15px;
      padding: 20px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
      margin-bottom: 30px;
    }

    .appointment-card {
      background-color: white;
      border-radius: 15px;
      padding: 25px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
      margin-bottom: 30px;
    }

    .table-responsive {
      overflow-x: auto;
    }

    .badge {
      padding: 5px 10px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
    }

    .stats-card {
      background: linear-gradient(135deg, #0B6A27, #095020);
      color: white;
      border-radius: 15px;
      padding: 20px;
      margin-bottom: 20px;
      text-align: center;
    }

    .stats-number {
      font-size: 36px;
      font-weight: 700;
      margin-bottom: 5px;
    }

    .stats-label {
      font-size: 14px;
      opacity: 0.9;
    }
  </style>
</head>

<body>
  <!-- Navbar -->
  <div class="navbar-container">
    <header>
      <div class="hospital-container">
        <div class="logo-container">
          <img src="logoright.jpg" alt="Logo Right" />
        </div>
        <div class="logo-container">
          <img src="logoleft.jpg" alt="Logo Left" />
        </div>
        <div class="hospital-name">
          <p class="hospital-line">Sebaste Community</p>
          <p class="hospital-line">Hospital</p>
        </div>
      </div>
      <div class="user-info">
        <div class="user-avatar">A</div>
        <div class="user-name">Admin <span class="admin-badge">Admin</span></div>
      </div>
    </header>
  </div>

  <!-- Dashboard Container -->
  <div class="dashboard-container">
    <!-- Sidebar -->
    <aside class="sidebar">
      <ul class="sidebar-menu">
        <li>
          <a href="admin-dashboard.html">
            <span class="icon">
              <svg width="24" height="24" viewBox="0 0 41 42" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M3.20312 21.9844V3.28125H15.6953V21.9844H3.20312Z" fill="currentColor"/>
                <path d="M25.3047 10.1719V3.28125H37.7969V10.1719H25.3047Z" fill="currentColor"/>
                <path d="M25.3047 38.7188V20.0156H37.7969V38.7188H25.3047Z" fill="currentColor"/>
                <path d="M3.20312 38.7188V31.8281H15.6953V38.7188H3.20312Z" fill="currentColor"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M22.1016 1.3125C22.1016 0.587626 22.6752 0 23.3828 0H39.7187C40.4264 0 41 0.587627 41 1.3125V12.1406C41 12.8655 40.4264 13.4531 39.7187 13.4531H23.3828C22.6752 13.4531 22.1016 12.8655 22.1016 12.1406V1.3125ZM25.3047 3.28125V10.1719H37.7969V3.28125H25.3047ZM22.1016 18.0469C22.1016 17.322 22.6752 16.7344 23.3828 16.7344H39.7187C40.4264 16.7344 41 17.322 41 18.0469V40.6875C41 41.4124 40.4264 42 39.7187 42H23.3828C22.6752 42 22.1016 41.4124 22.1016 40.6875V18.0469ZM25.3047 20.0156V38.7188H37.7969V20.0156H25.3047Z" fill="currentColor"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M17.6172 0H1.28125C0.573635 0 0 0.587626 0 1.3125V23.9531C0 24.678 0.573635 25.2656 1.28125 25.2656H17.6172C18.3248 25.2656 18.8984 24.678 18.8984 23.9531V1.3125C18.8984 0.587627 18.3248 0 17.6172 0ZM3.20312 3.28125V21.9844H15.6953V3.28125H3.20312Z" fill="currentColor"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M17.6172 28.5469H1.28125C0.573635 28.5469 0 29.1345 0 29.8594V40.6875C0 41.4124 0.573635 42 1.28125 42H17.6172C18.3248 42 18.8984 41.4124 18.8984 40.6875V29.8594C18.8984 29.1345 18.3248 28.5469 17.6172 28.5469ZM3.20312 31.8281V38.7188H15.6953V31.8281H3.20312Z" fill="currentColor"/>
              </svg>
            </span>
            <span class="menu-text">Dashboard</span>
          </a>
        </li>
        <li>
          <a href="admin-appointments.html" class="active">
            <span class="icon">
              <svg width="24" height="24" viewBox="0 0 45 48" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M3 17H42M3 17V37.5338C3 40.1474 3 41.4535 3.53134 42.4517C3.99873 43.3298 4.74396 44.0445 5.66125 44.4919C6.70305 45 8.06755 45 10.7925 45H34.2075C36.9324 45 38.295 45 39.3368 44.4919C40.2541 44.0445 41.0018 43.3298 41.4692 42.4517C42 41.4545 42 40.1501 42 37.5417V17M3 17V15.1338C3 12.5202 3 11.2124 3.53134 10.2142C3.99873 9.3361 4.74396 8.62271 5.66125 8.1753C6.70407 7.66667 8.07022 7.66667 10.8005 7.66667H12.75M42 17V15.1261C42 12.5177 42 11.2115 41.4692 10.2142C41.0018 9.3361 40.2541 8.62271 39.3368 8.1753C38.294 7.66667 36.9307 7.66667 34.2005 7.66667H32.25M12.75 7.66667H32.25M12.75 7.66667V3M32.25 7.66667V3M21.8906 35.6667C22.2272 35.6667 22.5 35.4055 22.5 35.0833V26.9167C22.5 26.5945 22.2272 26.3333 21.8906 26.3333H13.3594C13.0228 26.3333 12.75 26.5945 12.75 26.9167V35.0833C12.75 35.4055 13.0228 35.6667 13.3594 35.6667H21.8906Z" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </span>
            <span class="menu-text">Appointments</span>
          </a>
        </li>
        <li>
          <a href="admin-patient.html">
            <span class="icon">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M16 21V19C16 17.9391 15.5786 16.9217 14.8284 16.1716C14.0783 15.4214 13.0609 15 12 15H5C3.93913 15 2.92172 15.4214 2.17157 16.1716C1.42143 16.9217 1 17.9391 1 19V21M17.5 3.29076C18.9659 3.88415 20 5.32131 20 7C20 8.67869 18.9659 10.1159 17.5 10.7092M13.5 7C13.5 9.20914 11.7091 11 9.5 11C7.29086 11 5.5 9.20914 5.5 7C5.5 4.79086 7.29086 3 9.5 3C11.7091 3 13.5 4.79086 13.5 7Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </span>
            <span class="menu-text">Patients</span>
          </a>
        </li>
        <li>
          <a href="admin-staff.html">
            <span class="icon">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M17 21V19C17 17.9391 16.5786 16.9217 15.8284 16.1716C15.0783 15.4214 14.0609 15 13 15H5C3.93913 15 2.92172 15.4214 2.17157 16.1716C1.42143 16.9217 1 17.9391 1 19V21M23 21V19C22.9993 18.1137 22.7044 17.2528 22.1614 16.5523C21.6184 15.8519 20.8581 15.3516 20 15.13M16 3.13C16.8604 3.3503 17.623 3.8507 18.1676 4.55231C18.7122 5.25392 19.0078 6.11683 19.0078 7.005C19.0078 7.89317 18.7122 8.75608 18.1676 9.45769C17.623 10.1593 16.8604 10.6597 16 10.88M13 7C13 9.20914 11.2091 11 9 11C6.79086 11 5 9.20914 5 7C5 4.79086 6.79086 3 9 3C11.2091 3 13 4.79086 13 7Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </span>
            <span class="menu-text">Staff</span>
          </a>
        </li>


        <li>
          <a href="admin-settings.html">
            <span class="icon">
              <svg width="24" height="24" viewBox="0 0 50 51" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M18.3526 50.9167L17.3859 42.7834C16.8623 42.5716 16.3689 42.3174 15.9057 42.0209C15.4425 41.7243 14.9894 41.4066 14.5464 41.0678L7.35677 44.2448L0.710938 32.1719L6.93385 27.2157C6.89358 26.9191 6.87344 26.6332 6.87344 26.3579V24.6422C6.87344 24.3669 6.89358 24.0809 6.93385 23.7844L0.710938 18.8282L7.35677 6.75525L14.5464 9.93233C14.9894 9.59344 15.4526 9.27574 15.9359 8.97921C16.4193 8.68268 16.9026 8.42851 17.3859 8.21671L18.3526 0.083374H31.6443L32.6109 8.21671C33.1345 8.42851 33.628 8.68268 34.0911 8.97921C34.5543 9.27574 35.0075 9.59344 35.4505 9.93233L42.6401 6.75525L49.2859 18.8282L43.063 23.7844C43.1033 24.0809 43.1234 24.3669 43.1234 24.6422V26.3579C43.1234 26.6332 43.0832 26.9191 43.0026 27.2157L49.2255 32.1719L42.5797 44.2448L35.4505 41.0678C35.0075 41.4066 34.5443 41.7243 34.0609 42.0209C33.5776 42.3174 33.0943 42.5716 32.6109 42.7834L31.6443 50.9167H18.3526ZM25.1193 34.3959C27.4554 34.3959 29.4491 33.5275 31.1005 31.7907C32.7519 30.0539 33.5776 27.957 33.5776 25.5C33.5776 23.0431 32.7519 20.9462 31.1005 19.2094C29.4491 17.4726 27.4554 16.6042 25.1193 16.6042C22.7429 16.6042 20.7391 17.4726 19.1078 19.2094C17.4766 20.9462 16.6609 23.0431 16.6609 25.5C16.6609 27.957 17.4766 30.0539 19.1078 31.7907C20.7391 33.5275 22.7429 34.3959 25.1193 34.3959Z" fill="currentColor"/>
              </svg>
            </span>
            <span class="menu-text">Settings</span>
          </a>
        </li>
      </ul>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      <div class="dashboard-header">
        <h1>Appointment Management</h1>
      </div>

      <!-- Statistics Cards -->
      <div class="row mb-4">
        <div class="col-md-3">
          <div class="stats-card">
            <div class="stats-number" id="totalAppointments">0</div>
            <div class="stats-label">Total Appointments</div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="stats-card" style="background: linear-gradient(135deg, #ffc107, #e0a800);">
            <div class="stats-number" id="pendingAppointments">0</div>
            <div class="stats-label">Pending Approval</div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="stats-card" style="background: linear-gradient(135deg, #28a745, #1e7e34);">
            <div class="stats-number" id="approvedAppointments">0</div>
            <div class="stats-label">Approved</div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="stats-card" style="background: linear-gradient(135deg, #dc3545, #c82333);">
            <div class="stats-number" id="cancelledAppointments">0</div>
            <div class="stats-label">Cancelled</div>
          </div>
        </div>
      </div>

      <!-- Filters -->
      <div class="filter-card">
        <form>
          <div class="row">
            <div class="col-md-3">
              <label for="dateFilter" class="form-label">Date Range</label>
              <input type="date" class="form-control" id="dateFilter" onchange="filterAppointments()">
            </div>
            <div class="col-md-3">
              <label for="statusFilter" class="form-label">Status</label>
              <select class="form-select" id="statusFilter" onchange="filterAppointments()">
                <option value="">All Statuses</option>
                <option value="pending">Pending</option>
                <option value="approved">Approved</option>
                <option value="cancelled">Cancelled</option>
                <option value="completed">Completed</option>
              </select>
            </div>
            <div class="col-md-3">
              <label for="doctorFilter" class="form-label">Doctor</label>
              <select class="form-select" id="doctorFilter" onchange="filterAppointments()">
                <option value="">All Doctors</option>
                <option value="dr-nina-alvarez">Dr. Nina Alvarez</option>
                <option value="dr-david-torred">Dr. David Torred</option>
                <option value="dr-reggie-quinto">Dr. Reggie Quinto</option>
                <option value="dr-angela-torres">Dr. Angela Torres</option>
                <option value="dr-karen-yu">Dr. Karen Yu</option>
                <option value="dr-miguel-ramos">Dr. Miguel Ramos</option>
              </select>
            </div>
            <div class="col-md-3">
              <label for="search" class="form-label">Search</label>
              <div class="input-group">
                <input type="text" class="form-control" id="search" placeholder="Patient name or ID" onkeyup="filterAppointments()">
                <button class="btn btn-outline-secondary" type="button">
                  <i class="bi bi-search"></i>
                </button>
              </div>
            </div>
          </div>
        </form>
      </div>

      <!-- Appointment Table -->
      <div class="appointment-card">
        <div class="d-flex justify-content-between align-items-center mb-4">
          <h2 class="h4">Appointment Records</h2>
          <div>
            <button type="button" class="btn btn-success me-2" onclick="bulkApprove()">
              <i class="bi bi-check-circle me-2"></i>Bulk Approve Pending
            </button>
            <button type="button" class="btn btn-secondary" onclick="refreshAppointments()">
              <i class="bi bi-arrow-clockwise me-2"></i>Refresh
            </button>
          </div>
        </div>

        <div class="table-responsive">
          <table class="table table-hover">
            <thead>
              <tr>
                <!-- Patient ID column removed -->
                <th>Patient Name</th>
                <th>Date & Time</th>
                <th>Doctor</th>
                <th>Service</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="appointmentsTableBody">
              <!-- Appointments will be loaded here -->
            </tbody>
          </table>
        </div>

        <!-- Pagination -->
        <nav aria-label="Page navigation" class="mt-4">
          <ul class="pagination justify-content-center" id="pagination">
            <!-- Pagination will be generated here -->
          </ul>
        </nav>
      </div>
    </main>
  </div>

  <!-- Appointment Details Modal -->
  <div class="modal-overlay" id="appointmentModal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title">Appointment Details</h2>
        <button class="close-btn" onclick="closeModal()">&times;</button>
      </div>
      <div id="appointmentDetails">
        <!-- Details will be loaded here -->
      </div>
      <div class="form-actions">
        <button type="button" class="btn btn-secondary" onclick="closeModal()">Close</button>
        <button type="button" class="btn btn-success" id="approveBtn" onclick="updateStatus('approved')">Approve</button>
        <button type="button" class="btn btn-danger" id="rejectBtn" onclick="updateStatus('cancelled')">Reject</button>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    let currentAppointments = [];
    let filteredAppointments = [];
    let currentPage = 1;
    const appointmentsPerPage = 10;
    let selectedAppointmentId = null;

    // Load appointments from localStorage
    function loadAppointments() {
      ensurePatientIds(); // Ensure all appointments have patientId
      const appointments = JSON.parse(localStorage.getItem('appointments') || '[]');
      currentAppointments = appointments;
      filteredAppointments = appointments;
      updateStatistics();
      displayAppointments();
      generatePagination();
    }

    // Update statistics cards
    function updateStatistics() {
      const total = currentAppointments.length;
      const pending = currentAppointments.filter(apt => apt.status === 'pending').length;
      const approved = currentAppointments.filter(apt => apt.status === 'approved').length;
      const cancelled = currentAppointments.filter(apt => apt.status === 'cancelled').length;

      document.getElementById('totalAppointments').textContent = total;
      document.getElementById('pendingAppointments').textContent = pending;
      document.getElementById('approvedAppointments').textContent = approved;
      document.getElementById('cancelledAppointments').textContent = cancelled;
    }

    // Create patient record from approved appointment
    function createPatientRecord(appointment) {
      const patients = JSON.parse(localStorage.getItem('patients') || '[]');
      
      // Check if patient already exists
      const existingPatient = patients.find(patient => patient.patientId === appointment.patientId);
      
      if (!existingPatient) {
        const patientRecord = {
          patientId: appointment.patientId,
          firstName: appointment.firstName,
          middleName: appointment.middleName || '',
          lastName: appointment.lastName,
          fullName: `${appointment.firstName} ${appointment.middleName || ''} ${appointment.lastName}`.trim(),
          email: appointment.email,
          mobileNumber: appointment.mobileNumber,
          address: appointment.address,
          birthday: appointment.birthday,
          gender: appointment.gender,
          emergencyContactName: appointment.emergencyContactName,
          emergencyContactNumber: appointment.emergencyContactNumber,
          registrationDate: new Date().toISOString(),
          status: 'Active',
          lastAppointment: appointment.appointmentDate,
          totalAppointments: 1,
          medicalHistory: [],
          notes: `Patient registered through appointment approval on ${new Date().toLocaleDateString()}`
        };
        
        patients.push(patientRecord);
        localStorage.setItem('patients', JSON.stringify(patients));
        console.log('New patient record created:', patientRecord.patientId);
      } else {
        // Update existing patient's last appointment and total count
        existingPatient.lastAppointment = appointment.appointmentDate;
        existingPatient.totalAppointments = (existingPatient.totalAppointments || 0) + 1;
        localStorage.setItem('patients', JSON.stringify(patients));
        console.log('Updated existing patient record:', existingPatient.patientId);
      }
    }

    // Display appointments in table
    function displayAppointments() {
      const tableBody = document.getElementById('appointmentsTableBody');
      tableBody.innerHTML = '';

      const startIndex = (currentPage - 1) * appointmentsPerPage;
      const endIndex = startIndex + appointmentsPerPage;
      const appointmentsToShow = filteredAppointments.slice(startIndex, endIndex);

      if (appointmentsToShow.length === 0) {
        tableBody.innerHTML = '<tr><td colspan="6" class="text-center">No appointments found</td></tr>'; // Changed colspan from 7 to 6
        return;
      }

      appointmentsToShow.forEach(appointment => {
        const row = document.createElement('tr');
        
        // Format date and time
        const appointmentDate = new Date(appointment.appointmentDate);
        const formattedDate = appointmentDate.toLocaleDateString('en-US', { 
          year: 'numeric', 
          month: 'short', 
          day: 'numeric' 
        });
        
        // Format time
        const [hours, minutes] = appointment.appointmentTime.split(':');
        const hour = parseInt(hours);
        const ampm = hour >= 12 ? 'PM' : 'AM';
        const hour12 = hour % 12 || 12;
        const formattedTime = `${hour12}:${minutes} ${ampm}`;

        row.innerHTML = `
          <!-- Removed Patient ID column -->
          <td>${appointment.firstName} ${appointment.lastName}</td>
          <td>${formattedDate}<br><small class="text-muted">${formattedTime}</small></td>
          <td>${getDoctorName(appointment.doctor)}</td>
          <td>${getServiceName(appointment.serviceType)}</td>
          <td><span class="status-badge status-${appointment.status}">${capitalizeFirstLetter(appointment.status)}</span></td>
          <td>
            <button class="action-btn view-btn" onclick="viewAppointment('${appointment.patientId}')" title="View Details">
              <i class="bi bi-eye"></i>
            </button>
            ${appointment.status === 'pending' ? `
              <button class="action-btn approve-btn" onclick="quickApprove('${appointment.patientId}')" title="Quick Approve">
                <i class="bi bi-check-circle"></i>
              </button>
              <button class="action-btn reject-btn" onclick="quickReject('${appointment.patientId}')" title="Quick Reject">
                <i class="bi bi-x-circle"></i>
              </button>
            ` : ''}
          </td>
        `;
        
        tableBody.appendChild(row);
      });
    }

    // Generate pagination
    function generatePagination() {
      const totalPages = Math.ceil(filteredAppointments.length / appointmentsPerPage);
      const pagination = document.getElementById('pagination');
      pagination.innerHTML = '';

      if (totalPages <= 1) return;

      // Previous button
      const prevLi = document.createElement('li');
      prevLi.className = `page-item ${currentPage === 1 ? 'disabled' : ''}`;
      prevLi.innerHTML = `<a class="page-link" href="#" onclick="changePage(${currentPage - 1})">Previous</a>`;
      pagination.appendChild(prevLi);

      // Page numbers
      for (let i = 1; i <= totalPages; i++) {
        const li = document.createElement('li');
        li.className = `page-item ${i === currentPage ? 'active' : ''}`;
        li.innerHTML = `<a class="page-link" href="#" onclick="changePage(${i})">${i}</a>`;
        pagination.appendChild(li);
      }

      // Next button
      const nextLi = document.createElement('li');
      nextLi.className = `page-item ${currentPage === totalPages ? 'disabled' : ''}`;
      nextLi.innerHTML = `<a class="page-link" href="#" onclick="changePage(${currentPage + 1})">Next</a>`;
      pagination.appendChild(nextLi);
    }

    // Change page
    function changePage(page) {
      const totalPages = Math.ceil(filteredAppointments.length / appointmentsPerPage);
      if (page < 1 || page > totalPages) return;
      
      currentPage = page;
      displayAppointments();
      generatePagination();
    }

    // Filter appointments
    function filterAppointments() {
      const dateFilter = document.getElementById('dateFilter').value;
      const statusFilter = document.getElementById('statusFilter').value;
      const doctorFilter = document.getElementById('doctorFilter').value;
      const searchFilter = document.getElementById('search').value.toLowerCase();

      filteredAppointments = currentAppointments.filter(appointment => {
        const matchesDate = !dateFilter || appointment.appointmentDate === dateFilter;
        const matchesStatus = !statusFilter || appointment.status === statusFilter;
        const matchesDoctor = !doctorFilter || appointment.doctor === doctorFilter;
        const matchesSearch = !searchFilter || 
          appointment.firstName.toLowerCase().includes(searchFilter) ||
          appointment.lastName.toLowerCase().includes(searchFilter) ||
          appointment.patientId.toLowerCase().includes(searchFilter); // Keep search by patientId even if not displayed

        return matchesDate && matchesStatus && matchesDoctor && matchesSearch;
      });

      currentPage = 1;
      displayAppointments();
      generatePagination();
    }

    // View appointment details
    function viewAppointment(patientId) {
      const appointment = currentAppointments.find(apt => apt.patientId === patientId);
      if (!appointment) return;

      selectedAppointmentId = patientId;
      
      const appointmentDate = new Date(appointment.appointmentDate);
      const formattedDate = appointmentDate.toLocaleDateString('en-US', { 
        weekday: 'long',
        year: 'numeric', 
        month: 'long', 
        day: 'numeric' 
      });

      const [hours, minutes] = appointment.appointmentTime.split(':');
      const hour = parseInt(hours);
      const ampm = hour >= 12 ? 'PM' : 'AM';
      const hour12 = hour % 12 || 12;
      const formattedTime = `${hour12}:${minutes} ${ampm}`;

      const age = calculateAge(appointment.birthday);

      document.getElementById('appointmentDetails').innerHTML = `
        <div class="detail-row">
          <div class="detail-label">Full Name:</div>
          <div class="detail-value">${appointment.firstName} ${appointment.middleName || ''} ${appointment.lastName}</div>
        </div>
        <div class="detail-row">
          <div class="detail-label">Age:</div>
          <div class="detail-value">${age} years old</div>
        </div>
        <div class="detail-row">
          <div class="detail-label">Gender:</div>
          <div class="detail-value">${capitalizeFirstLetter(appointment.gender)}</div>
        </div>
        <div class="detail-row">
          <div class="detail-label">Contact:</div>
          <div class="detail-value">${appointment.mobileNumber}</div>
        </div>
        <div class="detail-row">
          <div class="detail-label">Email:</div>
          <div class="detail-value">${appointment.email}</div>
        </div>
        <div class="detail-row">
          <div class="detail-label">Address:</div>
          <div class="detail-value">${appointment.address}</div>
        </div>
        <div class="detail-row">
          <div class="detail-label">Appointment Date:</div>
          <div class="detail-value">${formattedDate}</div>
        </div>
        <div class="detail-row">
          <div class="detail-label">Appointment Time:</div>
          <div class="detail-value">${formattedTime}</div>
        </div>
        <div class="detail-row">
          <div class="detail-label">Doctor:</div>
          <div class="detail-value">${getDoctorName(appointment.doctor)}</div>
        </div>
        <div class="detail-row">
          <div class="detail-label">Service:</div>
          <div class="detail-value">${getServiceName(appointment.serviceType)}</div>
        </div>
        <div class="detail-row">
          <div class="detail-label">Status:</div>
          <div class="detail-value"><span class="status-badge status-${appointment.status}">${capitalizeFirstLetter(appointment.status)}</span></div>
        </div>
        ${appointment.companionName ? `
        <div class="detail-row">
          <div class="detail-label">Companion:</div>
          <div class="detail-value">${appointment.companionName} (${appointment.relationship || 'N/A'})</div>
        </div>
        ` : ''}
        <div class="detail-row">
          <div class="detail-label">Emergency Contact:</div>
          <div class="detail-value">${appointment.emergencyContactName} - ${appointment.emergencyContactNumber}</div>
        </div>
        <div class="detail-row">
          <div class="detail-label">Submitted:</div>
          <div class="detail-value">${new Date(appointment.submittedAt).toLocaleString()}</div>
        </div>
      `;

      // Show/hide action buttons based on status
      const approveBtn = document.getElementById('approveBtn');
      const rejectBtn = document.getElementById('rejectBtn');
      
      if (appointment.status === 'pending') {
        approveBtn.style.display = 'inline-block';
        rejectBtn.style.display = 'inline-block';
      } else {
        approveBtn.style.display = 'none';
        rejectBtn.style.display = 'none';
      }

      document.getElementById('appointmentModal').style.display = 'flex';
    }

    // Close modal
    function closeModal() {
      document.getElementById('appointmentModal').style.display = 'none';
      selectedAppointmentId = null;
    }

    // Update appointment status
    function updateStatus(newStatus) {
      if (!selectedAppointmentId) return;

      const appointments = JSON.parse(localStorage.getItem('appointments') || '[]');
      const appointmentIndex = appointments.findIndex(apt => apt.patientId === selectedAppointmentId);
      
      if (appointmentIndex === -1) return;

      appointments[appointmentIndex].status = newStatus;
      appointments[appointmentIndex].updatedAt = new Date().toISOString();
      
      // Create patient record if appointment is approved
      if (newStatus === 'approved') {
        createPatientRecord(appointments[appointmentIndex]);
      }
      
      localStorage.setItem('appointments', JSON.stringify(appointments));
      
      closeModal();
      loadAppointments();
      
      // Replaced alert with custom message box as per instructions
      showMessageBox(`Appointment has been ${newStatus === 'approved' ? 'approved' : 'rejected'} successfully!${newStatus === 'approved' ? ' Patient record has been created/updated.' : ''}`);
    }

    // Quick approve
    function quickApprove(patientId) {
      // Replaced confirm with custom message box as per instructions
      showConfirmBox('Are you sure you want to approve this appointment?', () => {
        const appointments = JSON.parse(localStorage.getItem('appointments') || '[]');
        const appointmentIndex = appointments.findIndex(apt => apt.patientId === patientId);
        
        if (appointmentIndex !== -1) {
          appointments[appointmentIndex].status = 'approved';
          appointments[appointmentIndex].updatedAt = new Date().toISOString();
          
          // Create patient record
          createPatientRecord(appointments[appointmentIndex]);
          
          localStorage.setItem('appointments', JSON.stringify(appointments));
          loadAppointments();
          // Replaced alert with custom message box as per instructions
          showMessageBox('Appointment approved successfully! Patient record has been created/updated.');
        }
      });
    }

    // Quick reject
    function quickReject(patientId) {
      // Replaced confirm with custom message box as per instructions
      showConfirmBox('Are you sure you want to reject this appointment?', () => {
        const appointments = JSON.parse(localStorage.getItem('appointments') || '[]');
        const appointmentIndex = appointments.findIndex(apt => apt.patientId === patientId);
        
        if (appointmentIndex !== -1) {
          appointments[appointmentIndex].status = 'cancelled';
          appointments[appointmentIndex].updatedAt = new Date().toISOString();
          localStorage.setItem('appointments', JSON.stringify(appointments));
          loadAppointments();
          // Replaced alert with custom message box as per instructions
          showMessageBox('Appointment rejected successfully!');
        }
      });
    }

    // Bulk approve pending appointments
    function bulkApprove() {
      const pendingAppointments = currentAppointments.filter(apt => apt.status === 'pending');
      
      if (pendingAppointments.length === 0) {
        // Replaced alert with custom message box as per instructions
        showMessageBox('No pending appointments to approve.');
        return;
      }

      // Replaced confirm with custom message box as per instructions
      showConfirmBox(`Are you sure you want to approve all ${pendingAppointments.length} pending appointments?`, () => {
        const appointments = JSON.parse(localStorage.getItem('appointments') || '[]');
        
        appointments.forEach(appointment => {
          if (appointment.status === 'pending') {
            appointment.status = 'approved';
            appointment.updatedAt = new Date().toISOString();
            // Create patient record for each approved appointment
            createPatientRecord(appointment);
          }
        });
        
        localStorage.setItem('appointments', JSON.stringify(appointments));
        loadAppointments();
        // Replaced alert with custom message box as per instructions
        showMessageBox(`${pendingAppointments.length} appointments approved successfully! Patient records have been created/updated.`);
      });
    }

    // Refresh appointments
    function refreshAppointments() {
      loadAppointments();
      // Replaced alert with custom message box as per instructions
      showMessageBox('Appointments refreshed!');
    }

    // Helper functions
    function getDoctorName(doctorId) {
      const doctorMap = {
        'dr-nina-alvarez': 'Dr. Nina Alvarez',
        'dr-david-torred': 'Dr. David Torred',
        'dr-reggie-quinto': 'Dr. Reggie Quinto',
        'dr-angela-torres': 'Dr. Angela Torres',
        'dr-karen-yu': 'Dr. Karen Yu',
        'dr-miguel-ramos': 'Dr. Miguel Ramos'
      };
      return doctorMap[doctorId] || doctorId;
    }

    function getServiceName(serviceType) {
      const serviceMap = {
        'general-checkup': 'General Check-up',
        'consultation': 'Consultation',
        'follow-up': 'Follow-up Visit',
        'vaccination': 'Vaccination',
        'laboratory': 'Laboratory Test',
        'dental': 'Dental Service',
        'other': 'Other'
      };
      return serviceMap[serviceType] || serviceType;
    }

    function capitalizeFirstLetter(string) {
      if (!string) return '';
      return string.charAt(0).toUpperCase() + string.slice(1);
    }

    function calculateAge(birthday) {
      if (!birthday) return 'N/A';
      const birthDate = new Date(birthday);
      const today = new Date();
      let age = today.getFullYear() - birthDate.getFullYear();
      const monthDiff = today.getMonth() - birthDate.getMonth();
      
      if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {
        age--;
      }
      
      return age;
    }

    // Custom Message Box implementation
    function showMessageBox(message) {
        const modalId = 'customAlertModal';
        let modal = document.getElementById(modalId);
        if (!modal) {
            modal = document.createElement('div');
            modal.id = modalId;
            modal.className = 'modal-overlay';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-header">
                        <h2 class="modal-title">Notification</h2>
                        <button class="close-btn" onclick="document.getElementById('${modalId}').style.display='none'">&times;</button>
                    </div>
                    <div class="modal-body" style="padding: 20px 0; color: #555;"></div>
                    <div class="form-actions" style="margin-top: 20px; text-align: right;">
                        <button type="button" class="btn btn-primary" onclick="document.getElementById('${modalId}').style.display='none'">OK</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }
        modal.querySelector('.modal-body').textContent = message;
        modal.style.display = 'flex';
    }

    // Custom Confirmation Box implementation
    function showConfirmBox(message, onConfirm) {
        const modalId = 'customConfirmModal';
        let modal = document.getElementById(modalId);
        if (!modal) {
            modal = document.createElement('div');
            modal.id = modalId;
            modal.className = 'modal-overlay';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-header">
                        <h2 class="modal-title">Confirmation</h2>
                        <button class="close-btn" onclick="document.getElementById('${modalId}').style.display='none'">&times;</button>
                    </div>
                    <div class="modal-body" style="padding: 20px 0; color: #555;"></div>
                    <div class="form-actions" style="margin-top: 20px; text-align: right;">
                        <button type="button" class="btn btn-secondary" onclick="document.getElementById('${modalId}').style.display='none'">Cancel</button>
                        <button type="button" class="btn btn-primary confirm-action-btn">Confirm</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            modal.querySelector('.confirm-action-btn').onclick = () => {
                onConfirm();
                modal.style.display = 'none';
            };
        } else {
             // Update the click handler for the confirm button
            modal.querySelector('.confirm-action-btn').onclick = () => {
                onConfirm();
                modal.style.display = 'none';
            };
        }
        modal.querySelector('.modal-body').textContent = message;
        modal.style.display = 'flex';
    }

    // Generate patient ID if not exists
    function generatePatientId() {
      const timestamp = Date.now();
      const random = Math.floor(Math.random() * 1000);
      return `PAT-${timestamp}-${random}`;
    }

    // Ensure all appointments have patientId
    function ensurePatientIds() {
      const appointments = JSON.parse(localStorage.getItem('appointments') || '[]');
      let updated = false;
      
      appointments.forEach(appointment => {
        if (!appointment.patientId) {
          appointment.patientId = generatePatientId();
          updated = true;
        }
      });
      
      if (updated) {
        localStorage.setItem('appointments', JSON.stringify(appointments));
      }
    }

    // Initialize on page load
    document.addEventListener('DOMContentLoaded', function() {
      loadAppointments();
      
      // Auto-refresh every 30 seconds to sync with patient submissions
      setInterval(loadAppointments, 30000);
    });

    // Close modal when clicking outside (for appointmentModal)
    document.getElementById('appointmentModal').addEventListener('click', function(e) {
      if (e.target === this) {
        closeModal();
      }
    });

    // Close custom alert/confirm modals when clicking outside
    document.addEventListener('click', function(e) {
        const customAlertModal = document.getElementById('customAlertModal');
        const customConfirmModal = document.getElementById('customConfirmModal');
        
        if (customAlertModal && e.target === customAlertModal) {
            customAlertModal.style.display = 'none';
        }
        if (customConfirmModal && e.target === customConfirmModal) {
            customConfirmModal.style.display = 'none';
        }
    });
  </script>
</body>
</html>
