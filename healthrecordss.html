<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Health Records - Sebaste Community Hospital</title>
 
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Poppins:wght@500;600;900&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }   
    
    body {
      font-family: 'Inter', sans-serif;
      margin: 0;
      padding: 0;
      min-height: 100vh;
      color: #333;
      background-color: #D7EEDE;
      overflow-x: hidden;
    }

    /* Background with white filter */
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: url('bg.jpg');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      opacity: 0.15;
      z-index: -1;
    }

    /* ===== NAVBAR STYLES ===== */
    .navbar-container {
      background-color: white;
      width: 100%;
      box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
      position: fixed;
      top: 0;
      left: 0;
      z-index: 1000;
    }

    .navbar-container header {
      height: 90px;
      padding: 0 40px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      max-width: 100%;
      margin: 0 auto;
      box-sizing: border-box;
    }

    .hospital-container {
      display: flex;
      align-items: center;
      gap: 15px;
      height: 100%;
    }

    .logo-container {
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100%;
      width: 60px;
      overflow: hidden;
    }

    .logo-container img {
      max-height: 79px;
      max-width: 100%;
      object-fit: contain;
    }

    .hospital-name {
      font-family: 'Poppins', sans-serif;
      font-size: 22px;
      font-weight: 600;
      color: #0B6A27;
      text-align: left;
      line-height: 1.2;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    .hospital-line {
      margin: 0;
      padding: 0;
    }

    /* User info in navbar */
    .user-info {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .user-avatar {
      width: 45px;
      height: 45px;
      border-radius: 50%;
      background-color: #0B6A27;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 600;
      font-size: 18px;
    }

    .user-name {
      font-weight: 600;
      font-size: 16px;
    }

    /* ===== DASHBOARD LAYOUT ===== */
    .dashboard-container {
      display: flex;
      margin-top: 90px;
      min-height: calc(100vh - 90px);
    }

    /* Sidebar styles */
    .sidebar {
      width: 280px;
      background-color: white;
      box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
      padding: 30px 0;
      position: fixed;
      top: 90px;
      left: 0;
      height: calc(100vh - 90px);
      overflow-y: auto;
      z-index: 100;
    }

    .sidebar-menu {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .sidebar-menu li {
      margin-bottom: 5px;
    }

    .sidebar-menu a {
      display: flex;
      align-items: center;
      padding: 15px 25px;
      text-decoration: none;
      color: #333;
      font-weight: 600;
      transition: all 0.3s ease;
      border-left: 4px solid transparent;
    }

    .sidebar-menu a:hover {
      background-color: rgba(11, 106, 39, 0.1);
    }

    .sidebar-menu a.active {
      background-color: rgba(11, 106, 39, 0.15);
      border-left: 4px solid #0B6A27;
      color: #0B6A27;
    }

    .sidebar-menu .icon {
      margin-right: 15px;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 24px;
      height: 24px;
    }

    .sidebar-menu .icon svg {
      width: 24px;
      height: 24px;
    }

    /* Main content area */
    .main-content {
      flex: 1;
      padding: 30px;
      margin-left: 280px;
      max-width: calc(100vw - 280px);
    }

    .dashboard-header {
      margin-bottom: 30px;
    }

    .dashboard-header h1 {
      font-family: 'Poppins', sans-serif;
      font-size: 32px;
      font-weight: 700;
      color: #333;
      margin-bottom: 10px;
    }

    .dashboard-header p {
      color: #666;
      font-size: 16px;
    }

    /* Health Records Styles */
    .records-container {
      max-width: 100%;
      margin: 0 auto;
    }

    .records-section {
      background-color: white;
      border-radius: 15px;
      padding: 30px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
      margin-bottom: 30px;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      width: 100%;
    }

    .records-section:hover {
      transform: translateY(-5px);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
    }

    .records-title {
      font-family: 'Poppins', sans-serif;
      font-size: 24px;
      font-weight: 600;
      color: #333;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 1px solid #eee;
      display: flex;
      align-items: center;
      flex-wrap: wrap;
    }

    .records-title svg {
      margin-right: 12px;
      color: #0B6A27;
      flex-shrink: 0;
    }

    .medical-info {
      margin-bottom: 20px;
    }

    .medical-info-row {
      display: flex;
      margin-bottom: 10px;
      border-bottom: 1px solid #f0f0f0;
      padding-bottom: 10px;
      flex-wrap: wrap;
    }

    .medical-info-label {
      flex: 1;
      font-weight: 600;
      color: #555;
      min-width: 150px;
      margin-bottom: 5px;
    }

    .medical-info-value {
      flex: 2;
      color: #333;
      min-width: 200px;
    }

    .btn {
      padding: 12px 24px;
      border-radius: 8px;
      font-family: 'Inter', sans-serif;
      font-weight: 600;
      font-size: 16px;
      cursor: pointer;
      border: none;
      transition: all 0.3s ease;
      display: inline-block;
      text-decoration: none;
    }

    .btn-primary {
      background-color: #0B6A27;
      color: white;
    }

    .btn-primary:hover {
      background-color: #095020;
    }

    .btn-secondary {
      background-color: #f0f0f0;
      color: #333;
    }

    .btn-secondary:hover {
      background-color: #e0e0e0;
    }

    .btn-sm {
      padding: 8px 16px;
      font-size: 14px;
    }

    .btn-icon {
      display: flex;
      align-items: center;
      gap: 8px;
      justify-content: center;
    }

    .btn-icon svg {
      width: 16px;
      height: 16px;
      flex-shrink: 0;
    }

    .action-buttons {
      display: flex;
      gap: 10px;
      margin-top: 20px;
      flex-wrap: wrap;
    }

    /* Table container for horizontal scrolling */
    .table-container {
      width: 100%;
      overflow-x: auto;
      margin-bottom: 20px;
    }

    /* Lab Results Table */
    .lab-results-table {
      width: 100%;
      min-width: 600px;
      border-collapse: collapse;
      margin-bottom: 20px;
    }

    .lab-results-table th,
    .lab-results-table td {
      padding: 12px 15px;
      text-align: left;
      border-bottom: 1px solid #eee;
      white-space: nowrap;
    }

    .lab-results-table th {
      background-color: rgba(11, 106, 39, 0.1);
      color: #333;
      font-weight: 600;
      position: sticky;
      top: 0;
    }

    .lab-results-table tr:hover {
      background-color: #f9f9f9;
    }

    .lab-results-table .status {
      font-weight: 600;
    }

    .lab-results-table .status.normal {
      color: #28a745;
    }

    .lab-results-table .status.abnormal {
      color: #dc3545;
    }

    .lab-results-table .status.pending {
      color: #ffc107;
    }

    .lab-results-table .status.completed {
      color: #28a745;
    }

    .lab-results-table .status.due {
      color: #ffc107;
    }

    /* Visit History */
    .visit-item {
      padding: 15px;
      border-left: 4px solid #0B6A27;
      background-color: #f9f9f9;
      margin-bottom: 15px;
      border-radius: 0 8px 8px 0;
      width: 100%;
    }

    .visit-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
      flex-wrap: wrap;
      gap: 10px;
    }

    .visit-date {
      font-weight: 600;
      color: #0B6A27;
    }

    .visit-doctor {
      color: #666;
    }

    .visit-details {
      margin-top: 10px;
    }

    .visit-diagnosis {
      font-weight: 600;
      margin-bottom: 5px;
    }

    .visit-treatment {
      color: #555;
    }

    .no-visits-message {
      text-align: center;
      padding: 40px 20px;
      color: #666;
      font-style: italic;
    }

    /* Tabs */
    .tabs {
      display: flex;
      margin-bottom: 20px;
      border-bottom: 1px solid #ddd;
      overflow-x: auto;
      white-space: nowrap;
    }

    .tab {
      padding: 10px 20px;
      cursor: pointer;
      border-bottom: 3px solid transparent;
      font-weight: 600;
      transition: all 0.3s ease;
      flex-shrink: 0;
    }

    .tab.active {
      border-bottom-color: #0B6A27;
      color: #0B6A27;
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    /* Mobile menu toggle */
    .mobile-menu-toggle {
      display: none;
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: #0B6A27;
    }

    /* Responsive Design */
    @media (min-width: 1600px) {
      .main-content {
        max-width: calc(100vw - 280px);
      }
      
      .records-container {
        max-width: 1400px;
      }
    }

    @media (max-width: 1200px) {
      .sidebar {
        width: 80px;
        padding: 20px 0;
      }

      .sidebar-menu a {
        padding: 15px;
        justify-content: center;
      }

      .sidebar-menu .icon {
        margin-right: 0;
      }

      .sidebar-menu .menu-text {
        display: none;
      }

      .main-content {
        margin-left: 80px;
        max-width: calc(100vw - 80px);
      }

      .medical-info-row {
        flex-direction: column;
        gap: 5px;
      }

      .medical-info-label,
      .medical-info-value {
        flex: none;
        min-width: auto;
      }
    }

    @media (max-width: 768px) {
      .navbar-container header {
        padding: 0 20px;
      }

      .hospital-name {
        font-size: 18px;
      }

      .user-name {
        display: none;
      }

      .main-content {
        padding: 20px;
      }

      .records-section {
        padding: 20px;
      }

      .records-title {
        font-size: 20px;
        flex-direction: column;
        align-items: flex-start;
        gap: 10px;
      }

      .tabs {
        overflow-x: auto;
        white-space: nowrap;
        -webkit-overflow-scrolling: touch;
      }

      .action-buttons {
        flex-direction: column;
      }

      .btn {
        width: 100%;
        justify-content: center;
      }

      .visit-header {
        flex-direction: column;
        gap: 5px;
      }

      .lab-results-table {
        min-width: 500px;
      }

      .lab-results-table th,
      .lab-results-table td {
        padding: 8px 10px;
        font-size: 14px;
      }
    }

    @media (max-width: 576px) {
      .navbar-container header {
        padding: 0 15px;
      }

      .hospital-container {
        gap: 10px;
      }

      .hospital-name {
        font-size: 16px;
      }

      .sidebar {
        width: 0;
        transform: translateX(-100%);
        transition: transform 0.3s ease;
      }

      .sidebar.active {
        width: 250px;
        transform: translateX(0);
      }

      .main-content {
        margin-left: 0;
        padding: 15px;
        max-width: 100vw;
      }

      .mobile-menu-toggle {
        display: block;
      }

      .dashboard-header h1 {
        font-size: 24px;
      }

      .records-section {
        padding: 15px;
      }

      .records-title {
        font-size: 18px;
      }

      .medical-info-row {
        padding-bottom: 8px;
        margin-bottom: 8px;
      }

      .medical-info-label {
        font-size: 14px;
        margin-bottom: 3px;
      }

      .medical-info-value {
        font-size: 14px;
      }

      .btn {
        padding: 10px 16px;
        font-size: 14px;
      }

      .lab-results-table {
        min-width: 400px;
      }

      .lab-results-table th,
      .lab-results-table td {
        padding: 6px 8px;
        font-size: 12px;
      }

      .visit-item {
        padding: 12px;
      }

      .tab {
        padding: 8px 15px;
        font-size: 14px;
      }
    }

    @media (max-width: 400px) {
      .main-content {
        padding: 10px;
      }

      .records-section {
        padding: 12px;
      }

      .action-buttons {
        gap: 8px;
      }

      .btn {
        padding: 8px 12px;
        font-size: 13px;
      }

      .lab-results-table {
        min-width: 350px;
      }
    }

    /* Print styles */
    @media print {
      .navbar-container,
      .sidebar,
      .action-buttons,
      .mobile-menu-toggle {
        display: none !important;
      }

      .main-content {
        margin-left: 0 !important;
        padding: 20px !important;
        max-width: 100% !important;
      }

      .records-section {
        break-inside: avoid;
        box-shadow: none !important;
        border: 1px solid #ddd !important;
      }
    }
  </style>
</head>

<body>
  <!-- Mobile Menu Toggle -->
  <button class="mobile-menu-toggle" onclick="toggleMobileMenu()">☰</button>

  <!-- Navbar -->
  <div class="navbar-container">
    <header>
      <div class="hospital-container">
        <div class="logo-container">
          <img src="logoright.jpg" alt="Logo Right" />
        </div>
        <div class="logo-container">
          <img src="logoleft.jpg" alt="Logo Left" />
        </div>
        <div class="hospital-name">
          <p class="hospital-line">Sebaste Community</p>
          <p class="hospital-line">Hospital</p>
        </div>
      </div>
      <div class="user-info">
        <div class="user-avatar" id="userAvatar">U</div>
        <div class="user-name" id="userName">User</div>
      </div>
    </header>
  </div>

  <!-- Dashboard Container -->
  <div class="dashboard-container">
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
      <ul class="sidebar-menu">
        <li>
          <a href="dash.html">
            <span class="icon">
              <svg width="24" height="24" viewBox="0 0 41 42" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M3.20312 21.9844V3.28125H15.6953V21.9844H3.20312Z" fill="currentColor"/>
                <path d="M25.3047 10.1719V3.28125H37.7969V10.1719H25.3047Z" fill="currentColor"/>
                <path d="M25.3047 38.7188V20.0156H37.7969V38.7188H25.3047Z" fill="currentColor"/>
                <path d="M3.20312 38.7188V31.8281H15.6953V38.7188H3.20312Z" fill="currentColor"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M22.1016 1.3125C22.1016 0.587626 22.6752 0 23.3828 0H39.7187C40.4264 0 41 0.587627 41 1.3125V12.1406C41 12.8655 40.4264 13.4531 39.7187 13.4531H23.3828C22.6752 13.4531 22.1016 12.8655 22.1016 12.1406V1.3125ZM25.3047 3.28125V10.1719H37.7969V3.28125H25.3047ZM22.1016 18.0469C22.1016 17.322 22.6752 16.7344 23.3828 16.7344H39.7187C40.4264 16.7344 41 17.322 41 18.0469V40.6875C41 41.4124 40.4264 42 39.7187 42H23.3828C22.6752 42 22.1016 41.4124 22.1016 40.6875V18.0469ZM25.3047 20.0156V38.7188H37.7969V20.0156H25.3047Z" fill="currentColor"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M17.6172 0H1.28125C0.573635 0 0 0.587626 0 1.3125V23.9531C0 24.678 0.573635 25.2656 1.28125 25.2656H17.6172C18.3248 25.2656 18.8984 24.678 18.8984 23.9531V1.3125C18.8984 0.587627 18.3248 0 17.6172 0ZM3.20312 3.28125V21.9844H15.6953V3.28125H3.20312Z" fill="currentColor"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M17.6172 28.5469H1.28125C0.573635 28.5469 0 29.1345 0 29.8594V40.6875C0 41.4124 0.573635 42 1.28125 42H17.6172C18.3248 42 18.8984 41.4124 18.8984 40.6875V29.8594C18.8984 29.1345 18.3248 28.5469 17.6172 28.5469ZM3.20312 31.8281V38.7188H15.6953V31.8281H3.20312Z" fill="currentColor"/>
              </svg>
            </span>
            <span class="menu-text">Dashboard</span>
          </a>
        </li>
        <li>
          <a href="appointments.html">
            <span class="icon">
              <svg width="24" height="24" viewBox="0 0 45 48" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M3 17H42M3 17V37.5338C3 40.1474 3 41.4535 3.53134 42.4517C3.99873 43.3298 4.74396 44.0445 5.66125 44.4919C6.70305 45 8.06755 45 10.7925 45H34.2075C36.9324 45 38.295 45 39.3368 44.4919C40.2541 44.0445 41.0018 43.3298 41.4692 42.4517C42 41.4545 42 40.1501 42 37.5417V17M3 17V15.1338C3 12.5202 3 11.2124 3.53134 10.2142C3.99873 9.3361 4.74396 8.62271 5.66125 8.1753C6.70407 7.66667 8.07022 7.66667 10.8005 7.66667H12.75M42 17V15.1261C42 12.5177 42 11.2115 41.4692 10.2142C41.0018 9.3361 40.2541 8.62271 39.3368 8.1753C38.294 7.66667 36.9307 7.66667 34.2005 7.66667H32.25M12.75 7.66667H32.25M12.75 7.66667V3M32.25 7.66667V3M21.8906 35.6667C22.2272 35.6667 22.5 35.4055 22.5 35.0833V26.9167C22.5 26.5945 22.2272 26.3333 21.8906 26.3333H13.3594C13.0228 26.3333 12.75 26.5945 12.75 26.9167V35.0833C12.75 35.4055 13.0228 35.6667 13.3594 35.6667H21.8906Z" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </span>
            <span class="menu-text">Appointments</span>
          </a>
        </li>
        <li>
          <a href="healthrecordss.html" class="active">
            <span class="icon">
              <svg width="24" height="24" viewBox="0 0 54 50" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M32.654 30.5L24.5665 27.75V16.251M46.133 25C46.133 12.8497 36.4774 3 24.5665 3C12.6557 3 3 12.8497 3 25C3 37.1503 12.6557 47 24.5665 47C32.5492 47 39.5189 42.5758 43.2478 36M40.2167 22.5857L45.6084 28.0857L51 22.5857" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </span>
            <span class="menu-text">Health Records</span>
          </a>
        </li>
        <li>
          <a href="settings.html">
            <span class="icon">
              <svg width="24" height="24" viewBox="0 0 50 51" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M18.3526 50.9167L17.3859 42.7834C16.8623 42.5716 16.3689 42.3174 15.9057 42.0209C15.4425 41.7243 14.9894 41.4066 14.5464 41.0678L7.35677 44.2448L0.710938 32.1719L6.93385 27.2157C6.89358 26.9191 6.87344 26.6332 6.87344 26.3579V24.6422C6.87344 24.3669 6.89358 24.0809 6.93385 23.7844L0.710938 18.8282L7.35677 6.75525L14.5464 9.93233C14.9894 9.59344 15.4526 9.27574 15.9359 8.97921C16.4193 8.68268 16.9026 8.42851 17.3859 8.21671L18.3526 0.083374H31.6443L32.6109 8.21671C33.1345 8.42851 33.628 8.68268 34.0911 8.97921C34.5543 9.27574 35.0075 9.59344 35.4505 9.93233L42.6401 6.75525L49.2859 18.8282L43.063 23.7844C43.1033 24.0809 43.1234 24.3669 43.1234 24.6422V26.3579C43.1234 26.6332 43.0832 26.9191 43.0026 27.2157L49.2255 32.1719L42.5797 44.2448L35.4505 41.0678C35.0075 41.4066 34.5443 41.7243 34.0609 42.0209C33.5776 42.3174 33.0943 42.5716 32.6109 42.7834L31.6443 50.9167H18.3526ZM25.1193 34.3959C27.4554 34.3959 29.4491 33.5275 31.1005 31.7907C32.7519 30.0539 33.5776 27.957 33.5776 25.5C33.5776 23.0431 32.7519 20.9462 31.1005 19.2094C29.4491 17.4726 27.4554 16.6042 25.1193 16.6042C22.7429 16.6042 20.7391 17.4726 19.1078 19.2094C17.4766 20.9462 16.6609 23.0431 16.6609 25.5C16.6609 27.957 17.4766 30.0539 19.1078 31.7907C20.7391 33.5275 22.7429 34.3959 25.1193 34.3959Z" fill="currentColor"/>
              </svg>
            </span>
            <span class="menu-text">Settings</span>
          </a>
        </li>
      </ul>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      <div class="dashboard-header">
        <h1>Health Records</h1>
        <p>View and manage your complete medical history and health information</p>
      </div>

      <!-- Health Records Container -->
      <div class="records-container">
        <!-- Medical Summary Section -->
        <div class="records-section">
          <h2 class="records-title">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M22 12h-4l-3 9L9 3l-3 9H2"></path>
            </svg>
            Medical Summary
          </h2>
          <div id="medical-summary">
            <div class="medical-info">
              <div class="medical-info-row">
                <div class="medical-info-label">Blood Type:</div>
                <div class="medical-info-value" id="bloodTypeValue">Not specified</div>
              </div>
              <div class="medical-info-row">
                <div class="medical-info-label">Allergies:</div>
                <div class="medical-info-value" id="allergiesValue">None</div>
              </div>
              <div class="medical-info-row">
                <div class="medical-info-label">Chronic Conditions:</div>
                <div class="medical-info-value" id="chronicConditionsValue">None</div>
              </div>
              <div class="medical-info-row">
                <div class="medical-info-label">Current Medications:</div>
                <div class="medical-info-value" id="currentMedicationsValue">None</div>
              </div>
              <div class="medical-info-row">
                <div class="medical-info-label">Past Surgeries:</div>
                <div class="medical-info-value" id="pastSurgeriesValue">None</div>
              </div>
              <div class="medical-info-row">
                <div class="medical-info-label">Immunizations:</div>
                <div class="medical-info-value" id="immunizationsValue">None</div>
              </div>
            </div>
            <div class="action-buttons">
              <a href="#" class="btn btn-primary btn-icon" onclick="downloadMedicalSummary()">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                  <polyline points="7 10 12 15 17 10"></polyline>
                  <line x1="12" y1="15" x2="12" y2="3"></line>
                </svg>
                Download Summary
              </a>
              <a href="#" class="btn btn-secondary btn-icon" onclick="printMedicalSummary()">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <polyline points="6 9 6 2 18 2 18 9"></polyline>
                  <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path>
                  <rect x="6" y="14" width="12" height="8"></rect>
                </svg>
                Print Summary
              </a>
            </div>
          </div>
        </div>

        <!-- Lab Results Section -->
        <div class="records-section">
          <h2 class="records-title">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
              <polyline points="14 2 14 8 20 8"></polyline>
              <line x1="16" y1="13" x2="8" y2="13"></line>
              <line x1="16" y1="17" x2="8" y2="17"></line>
              <polyline points="10 9 9 9 8 9"></polyline>
            </svg>
            Lab Results
          </h2>
          
          <div class="tabs">
            <div class="tab active" onclick="switchTab('recent-results', this)">Recent Results</div>
            <div class="tab" onclick="switchTab('all-results', this)">All Results</div>
            <div class="tab" onclick="switchTab('pending-results', this)">Pending</div>
          </div>
          
          <div id="recent-results" class="tab-content active">
            <div class="table-container">
              <table class="lab-results-table">
                <thead>
                  <tr>
                    <th>Test Name</th>
                    <th>Date</th>
                    <th>Result</th>
                    <th>Reference Range</th>
                    <th>Status</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>Complete Blood Count (CBC)</td>
                    <td>May 15, 2025</td>
                    <td>View Details</td>
                    <td>Multiple</td>
                    <td><span class="status normal">Normal</span></td>
                  </tr>
                  <tr>
                    <td>Lipid Panel</td>
                    <td>May 15, 2025</td>
                    <td>View Details</td>
                    <td>Multiple</td>
                    <td><span class="status abnormal">Abnormal</span></td>
                  </tr>
                  <tr>
                    <td>Urinalysis</td>
                    <td>May 15, 2025</td>
                    <td>View Details</td>
                    <td>Multiple</td>
                    <td><span class="status normal">Normal</span></td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
          
          <div id="all-results" class="tab-content">
            <div class="table-container">
              <table class="lab-results-table">
                <thead>
                  <tr>
                    <th>Test Name</th>
                    <th>Date</th>
                    <th>Result</th>
                    <th>Reference Range</th>
                    <th>Status</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>Complete Blood Count (CBC)</td>
                    <td>May 15, 2025</td>
                    <td>View Details</td>
                    <td>Multiple</td>
                    <td><span class="status normal">Normal</span></td>
                  </tr>
                  <tr>
                    <td>Lipid Panel</td>
                    <td>May 15, 2025</td>
                    <td>View Details</td>
                    <td>Multiple</td>
                    <td><span class="status abnormal">Abnormal</span></td>
                  </tr>
                  <tr>
                    <td>Urinalysis</td>
                    <td>May 15, 2025</td>
                    <td>View Details</td>
                    <td>Multiple</td>
                    <td><span class="status normal">Normal</span></td>
                  </tr>
                  <tr>
                    <td>Comprehensive Metabolic Panel</td>
                    <td>Jan 10, 2025</td>
                    <td>View Details</td>
                    <td>Multiple</td>
                    <td><span class="status normal">Normal</span></td>
                  </tr>
                  <tr>
                    <td>Thyroid Function Test</td>
                    <td>Jan 10, 2025</td>
                    <td>View Details</td>
                    <td>Multiple</td>
                    <td><span class="status normal">Normal</span></td>
                  </tr>
                  <tr>
                    <td>Hemoglobin A1C</td>
                    <td>Oct 5, 2024</td>
                    <td>View Details</td>
                    <td>4.0-5.6%</td>
                    <td><span class="status normal">Normal</span></td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
          
          <div id="pending-results" class="tab-content">
            <div class="table-container">
              <table class="lab-results-table">
                <thead>
                  <tr>
                    <th>Test Name</th>
                    <th>Ordered Date</th>
                    <th>Ordered By</th>
                    <th>Expected Date</th>
                    <th>Status</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>Vitamin D, 25-Hydroxy</td>
                    <td>May 20, 2025</td>
                    <td>Dr. Nina Alvarez</td>
                    <td>May 27, 2025</td>
                    <td><span class="status pending">Pending</span></td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
          
          <div class="action-buttons">
            <a href="#" class="btn btn-primary btn-icon" onclick="downloadLabResults()">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="7 10 12 15 17 10"></polyline>
                <line x1="12" y1="15" x2="12" y2="3"></line>
              </svg>
              Download Results
            </a>
            <a href="#" class="btn btn-secondary btn-icon" onclick="printLabResults()">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polyline points="6 9 6 2 18 2 18 9"></polyline>
                <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path>
                <rect x="6" y="14" width="12" height="8"></rect>
              </svg>
              Print Results
            </a>
          </div>
        </div>

        <!-- Visit History Section -->
        <div class="records-section">
          <h2 class="records-title">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
              <line x1="16" y1="2" x2="16" y2="6"></line>
              <line x1="8" y1="2" x2="8" y2="6"></line>
              <line x1="3" y1="10" x2="21" y2="10"></line>
            </svg>
            Visit History
          </h2>
          
          <div id="visitHistoryContainer">
            <!-- Visit history will be populated by JavaScript -->
          </div>
          
          <div class="action-buttons">
            <a href="#" class="btn btn-primary btn-icon" onclick="downloadVisitHistory()">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="7 10 12 15 17 10"></polyline>
                <line x1="12" y1="15" x2="12" y2="3"></line>
              </svg>
              Download Visit History
            </a>
            <a href="#" class="btn btn-secondary btn-icon" onclick="printVisitHistory()">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polyline points="6 9 6 2 18 2 18 9"></polyline>
                <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path>
                <rect x="6" y="14" width="12" height="8"></rect>
              </svg>
              Print Visit History
            </a>
          </div>
        </div>

        <!-- Vaccination History Section -->
        <div class="records-section">
          <h2 class="records-title">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M9 12l2 2 4-4"></path>
              <path d="M21 12c.552 0 1-.448 1-1V8a2 2 0 0 0-2-2h-1V4a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v2H4a2 2 0 0 0-2 2v3c0 .552.448 1 1 1h1v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8h1z"></path>
            </svg>
            Vaccination History
          </h2>
          <div class="table-container">
            <table class="lab-results-table" id="vaccinationTable">
              <thead>
                <tr>
                  <th>Patient ID No.</th>
                  <th>Vaccine Name</th>
                  <th>Vaccine Type</th>
                  <th>Date of Vaccination</th>
                  <th>Time of Vaccination</th>
                  <th>Next Dose</th>
                  <th>Injection Site</th>
                  <th>Administered By</th>
                  <th>Remarks/Notes</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td id="vaccinationPatientId">N/A</td>
                  <td id="vaccinationVaccineName">N/A</td>
                  <td id="vaccinationVaccineType">N/A</td>
                  <td id="vaccinationVaccineDate">N/A</td>
                  <td>N/A</td>
                  <td id="vaccinationNextDose">N/A</td>
                  <td>N/A</td>
                  <td id="vaccinationAdministeredBy">N/A</td>
                  <td id="vaccinationRemarks">N/A</td>
                </tr>
              </tbody>
            </table>
          </div>
          
          <div class="action-buttons">
            <a href="#" class="btn btn-primary btn-icon" onclick="downloadVaccinationHistory()">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="7 10 12 15 17 10"></polyline>
                <line x1="12" y1="15" x2="12" y2="3"></line>
              </svg>
              Download Vaccination Records
            </a>
            <a href="#" class="btn btn-secondary btn-icon" onclick="printVaccinationHistory()">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polyline points="6 9 6 2 18 2 18 9"></polyline>
                <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path>
                <rect x="6" y="14" width="12" height="8"></rect>
              </svg>
              Print Vaccination Records
            </a>
          </div>
        </div>
      </div>
    </main>
  </div>

  <script>
    // User Management System using localStorage
    class UserManager {
      constructor() {
        this.currentUser = null;
        this.loadCurrentUser();
      }

      // Load current user from localStorage
      loadCurrentUser() {
        try {
          const currentUser = localStorage.getItem('currentUser');
          this.currentUser = currentUser ? JSON.parse(currentUser) : null;
        } catch (error) {
          console.error('Error loading current user:', error);
          this.currentUser = null;
        }
      }

      // Get current user
      getCurrentUser() {
        return this.currentUser;
      }
    }

    // Initialize user manager
    const userManager = new UserManager();

    // Mobile menu toggle function
    function toggleMobileMenu() {
      const sidebar = document.getElementById('sidebar');
      sidebar.classList.toggle('active');
    }

    // Close mobile menu when clicking outside
    document.addEventListener('click', function(event) {
      const sidebar = document.getElementById('sidebar');
      const toggle = document.querySelector('.mobile-menu-toggle');
      
      if (!sidebar.contains(event.target) && !toggle.contains(event.target)) {
        sidebar.classList.remove('active');
      }
    });

    // Load patient data from localStorage when page loads
    function loadPatientData() {
      try {
        const currentUser = userManager.getCurrentUser();
        
        if (currentUser) {
          // Update user info in navbar
          const userAvatar = document.getElementById('userAvatar');
          const userName = document.getElementById('userName');
          
          if (currentUser.firstName) {
            userAvatar.textContent = currentUser.firstName.charAt(0).toUpperCase();
            userName.textContent = currentUser.firstName;
          }
          
          // Update medical summary with patient data
          updateMedicalSummary(currentUser);
          
          // Update vaccination table
          updateVaccinationTable(currentUser);
          
          console.log('Patient data loaded successfully');
        } else {
          console.log('No current user found');
          window.location.href = 'index.html';
        }
      } catch (error) {
        console.error('Error loading patient data:', error);
        window.location.href = 'index.html';
      }
    }

    // Load and display visit history from completed appointments
    function loadVisitHistory() {
      try {
        const appointments = JSON.parse(localStorage.getItem('appointments') || '[]');
        const currentUser = userManager.getCurrentUser();
        const visitHistoryContainer = document.getElementById('visitHistoryContainer');
        
        // Filter appointments for current user
        const userAppointments = appointments.filter(apt => apt.email === currentUser.email);
        
        // Filter completed appointments (past dates or completed status)
        const completedAppointments = userAppointments.filter(apt => {
          const aptDate = new Date(apt.appointmentDate);
          const today = new Date();
          today.setHours(0, 0, 0, 0); // Reset time to compare dates only
          
          return aptDate < today || apt.status === 'completed';
        }).sort((a, b) => new Date(b.appointmentDate) - new Date(a.appointmentDate)); // Sort by date, newest first

        if (completedAppointments.length === 0) {
          visitHistoryContainer.innerHTML = `
            <div class="no-visits-message">
              <p>No visit history available. Complete appointments will appear here after the appointment date has passed.</p>
              <p><a href="appointments.html" style="color: #0B6A27; text-decoration: none; font-weight: 600;">Schedule your first appointment</a></p>
            </div>
          `;
        } else {
          let visitHistoryHTML = '';
          
          completedAppointments.forEach(apt => {
            const serviceType = apt.serviceType.replace(/-/g, ' ').replace(/\b\w/g, c => c.toUpperCase());
            const doctorName = apt.doctor.replace(/dr-/g, 'Dr. ').replace(/-/g, ' ').replace(/\b\w/g, c => c.toUpperCase());
            const appointmentDate = new Date(apt.appointmentDate).toLocaleDateString('en-US', {
              year: 'numeric',
              month: 'long',
              day: 'numeric'
            });

            // Generate basic diagnosis and treatment based on service type
            let diagnosis, treatment;
            switch (apt.serviceType) {
              case 'general-checkup':
                diagnosis = 'Annual Physical Examination';
                treatment = 'No treatment required. Recommended regular exercise and balanced diet.';
                break;
              case 'consultation':
                diagnosis = 'Medical Consultation';
                treatment = 'Consultation completed. Follow-up as needed.';
                break;
              case 'follow-up':
                diagnosis = 'Follow-up Visit';
                treatment = 'Continued monitoring and care as prescribed.';
                break;
              case 'vaccination':
                diagnosis = 'Vaccination Administration';
                treatment = 'Vaccination completed successfully. Monitor for any adverse reactions.';
                break;
              case 'laboratory':
                diagnosis = 'Laboratory Test';
                treatment = 'Laboratory tests completed. Results reviewed with patient.';
                break;
              case 'dental':
                diagnosis = 'Dental Examination';
                treatment = 'Dental care completed. Maintain good oral hygiene.';
                break;
              default:
                diagnosis = serviceType;
                treatment = 'Treatment completed as per medical assessment.';
            }

            visitHistoryHTML += `
              <div class="visit-item">
                <div class="visit-header">
                  <div class="visit-date">${appointmentDate}</div>
                  <div class="visit-doctor">${doctorName}</div>
                </div>
                <div class="visit-details">
                  <div class="visit-diagnosis">Diagnosis: ${diagnosis}</div>
                  <div class="visit-treatment">Treatment: ${treatment}</div>
                </div>
              </div>
            `;
          });
          
          visitHistoryContainer.innerHTML = visitHistoryHTML;
        }
      } catch (error) {
        console.error('Error loading visit history:', error);
        document.getElementById('visitHistoryContainer').innerHTML = `
          <div class="no-visits-message">
            <p>Error loading visit history. Please try again later.</p>
          </div>
        `;
      }
    }
    
    // Update medical summary section with patient data
    function updateMedicalSummary(patientData) {
      // Blood Type
      if (patientData.bloodType) {
        document.getElementById('bloodTypeValue').textContent = patientData.bloodType;
      }
      
      // Allergies
      let allergiesText = 'None';
      if (patientData.hasAllergies === 'Yes' && patientData.allergySpecification) {
        allergiesText = patientData.allergySpecification;
      }
      document.getElementById('allergiesValue').textContent = allergiesText;
      
      // Chronic Conditions
      let conditionsText = 'None';
      if (patientData.medicalConditions && patientData.medicalConditions.length > 0) {
        conditionsText = patientData.medicalConditions.join(', ');
        if (patientData.medicalConditions.includes('Other') && patientData.otherConditionDetails) {
          conditionsText += `, ${patientData.otherConditionDetails}`;
        }
      }
      document.getElementById('chronicConditionsValue').textContent = conditionsText;
      
      // Current Medications
      let medicationsText = 'None';
      if (patientData.hasMedications === 'Yes' && patientData.medications && patientData.medications.length > 0) {
        const medicationsList = patientData.medications
          .filter(med => med.name || med.dosage || med.reason)
          .map(med => {
            let medText = med.name || 'Unknown medication';
            if (med.dosage) medText += ` ${med.dosage}`;
            if (med.reason) medText += ` (${med.reason})`;
            return medText;
          });
        if (medicationsList.length > 0) {
          medicationsText = medicationsList.join(', ');
        }
      }
      document.getElementById('currentMedicationsValue').textContent = medicationsText;
      
      // Past Surgeries
      let surgeriesText = 'None';
      if (patientData.hasSurgeries === 'Yes' && patientData.surgerySpecification) {
        surgeriesText = patientData.surgerySpecification;
      }
      document.getElementById('pastSurgeriesValue').textContent = surgeriesText;
      
      // Immunizations - using vaccination data
      let immunizationsText = 'None';
      if (patientData.vaccineName && patientData.vaccineType) {
        immunizationsText = `${patientData.vaccineType}`;
        if (patientData.vaccineDate) {
          const date = new Date(patientData.vaccineDate);
          immunizationsText += ` (${date.getFullYear()})`;
        }
      }
      document.getElementById('immunizationsValue').textContent = immunizationsText;
    }
    
    // Update vaccination table with patient data
    function updateVaccinationTable(patientData) {
      if (patientData.patientIdNo) {
        document.getElementById('vaccinationPatientId').textContent = patientData.patientIdNo;
      }
      
      if (patientData.vaccineName) {
        document.getElementById('vaccinationVaccineName').textContent = patientData.vaccineName;
      }
      
      if (patientData.vaccineType) {
        document.getElementById('vaccinationVaccineType').textContent = patientData.vaccineType;
      }
      
      if (patientData.vaccineDate) {
        const date = new Date(patientData.vaccineDate);
        document.getElementById('vaccinationVaccineDate').textContent = date.toLocaleDateString();
      }
      
      if (patientData.nextDose) {
        document.getElementById('vaccinationNextDose').textContent = patientData.nextDose;
      }
      
      if (patientData.administeredBy) {
        document.getElementById('vaccinationAdministeredBy').textContent = patientData.administeredBy;
      }
      
      if (patientData.vaccineRemarks) {
        document.getElementById('vaccinationRemarks').textContent = patientData.vaccineRemarks;
      }
    }
    
    // Tab switching functionality
    function switchTab(tabId, tabElement) {
      // Hide all tab contents
      const tabContents = document.querySelectorAll('.tab-content');
      tabContents.forEach(tab => {
        tab.classList.remove('active');
      });
      
      // Show the selected tab content
      document.getElementById(tabId).classList.add('active');
      
      // Update active tab styling
      const tabs = document.querySelectorAll('.tab');
      tabs.forEach(tab => {
        tab.classList.remove('active');
      });
      tabElement.classList.add('active');
    }
    
    // Download/Print functions
    function downloadMedicalSummary() {
      const summaryElement = document.getElementById('medical-summary');
      const htmlContent = `
        <html>
        <head>
          <title>Medical Summary</title>
          <style>
            body { font-family: 'Inter', sans-serif; padding: 20px; background: #fff; }
            .medical-info-row { margin-bottom: 10px; border-bottom: 1px solid #ccc; padding-bottom: 10px; }
            .medical-info-label { font-weight: bold; color: #0B6A27; }
            .btn { display: none; }
          </style>
        </head>
        <body>
          ${summaryElement.outerHTML}
        </body>
        </html>
      `;
      const blob = new Blob([htmlContent], { type: 'text/html' });
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = 'medical_summary.html';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(a.href);

      alert('Downloading Medical Summary...');
    }

    function printMedicalSummary() {
      const summaryElement = document.getElementById('medical-summary');
      const printWindow = window.open('', '', 'width=800,height=600');
      printWindow.document.write(`
        <html>
        <head>
          <title>Print Medical Summary</title>
          <style>
            body { font-family: 'Inter', sans-serif; padding: 20px; background: #fff; }
            .medical-info-row { margin-bottom: 10px; border-bottom: 1px solid #ccc; padding-bottom: 10px; }
            .medical-info-label { font-weight: bold; color: #0B6A27; }
            .btn { display: none; }
          </style>
        </head>
        <body>
          ${summaryElement.outerHTML}
        </body>
        </html>
      `);
      printWindow.document.close();
      printWindow.focus();
      printWindow.print();
      printWindow.close();

      alert('Preparing Medical Summary for printing...');
    }
    
    function downloadLabResults() {
      const section = document.querySelector('.records-section:nth-of-type(2)');
      const htmlContent = `
        <html>
        <head>
          <title>Lab Results</title>
          <style>
            body { font-family: 'Inter', sans-serif; padding: 20px; background: #fff; }
            table { width: 100%; border-collapse: collapse; }
            th, td { padding: 10px; border: 1px solid #ccc; }
            .btn { display: none; }
          </style>
        </head>
        <body>
          ${section.outerHTML}
        </body>
        </html>
      `;
      const blob = new Blob([htmlContent], { type: 'text/html' });
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = 'lab_results.html';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(a.href);

      alert('Downloading Lab Results...');
    }

    function printLabResults() {
      const section = document.querySelector('.records-section:nth-of-type(2)');
      const printWindow = window.open('', '', 'width=800,height=600');
      printWindow.document.write(`
        <html>
        <head>
          <title>Print Lab Results</title>
          <style>
            body { font-family: 'Inter', sans-serif; padding: 20px; background: #fff; }
            table { width: 100%; border-collapse: collapse; }
            th, td { padding: 10px; border: 1px solid #ccc; }
            .btn { display: none; }
          </style>
        </head>
        <body>
          ${section.outerHTML}
        </body>
        </html>
      `);
      printWindow.document.close();
      printWindow.focus();
      printWindow.print();
      printWindow.close();

      alert('Preparing Lab Results for printing...');
    }

    function downloadVisitHistory() {
      const section = document.querySelector('.records-section:nth-of-type(3)');
      const htmlContent = `
        <html>
        <head>
          <title>Visit History</title>
          <style>
            body { font-family: 'Inter', sans-serif; padding: 20px; background: #fff; }
            .visit-item { margin-bottom: 15px; border-left: 4px solid #0B6A27; padding-left: 10px; }
            .btn { display: none; }
          </style>
        </head>
        <body>
          ${section.outerHTML}
        </body>
        </html>
      `;
      const blob = new Blob([htmlContent], { type: 'text/html' });
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = 'visit_history.html';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(a.href);

      alert('Downloading Visit History...');
    }

    function printVisitHistory() {
      const section = document.querySelector('.records-section:nth-of-type(3)');
      const printWindow = window.open('', '', 'width=800,height=600');
      printWindow.document.write(`
        <html>
        <head>
          <title>Print Visit History</title>
          <style>
            body { font-family: 'Inter', sans-serif; padding: 20px; background: #fff; }
            .visit-item { margin-bottom: 15px; border-left: 4px solid #0B6A27; padding-left: 10px; }
            .btn { display: none; }
          </style>
        </head>
        <body>
          ${section.outerHTML}
        </body>
        </html>
      `);
      printWindow.document.close();
      printWindow.focus();
      printWindow.print();
      printWindow.close();

      alert('Preparing Visit History for printing...');
    }

    function downloadVaccinationHistory() {
      const section = document.querySelector('.records-section:nth-of-type(4)');
      const htmlContent = `
        <html>
        <head>
          <title>Vaccination Records</title>
          <style>
            body { font-family: 'Inter', sans-serif; padding: 20px; background: #fff; }
            table { width: 100%; border-collapse: collapse; }
            th, td { padding: 10px; border: 1px solid #ccc; }
            .btn { display: none; }
          </style>
        </head>
        <body>
          ${section.outerHTML}
        </body>
        </html>
      `;
      const blob = new Blob([htmlContent], { type: 'text/html' });
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = 'vaccination_records.html';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(a.href);

      alert('Downloading Vaccination Records...');
    }

    function printVaccinationHistory() {
      const section = document.querySelector('.records-section:nth-of-type(4)');
      const printWindow = window.open('', '', 'width=800,height=600');
      printWindow.document.write(`
        <html>
        <head>
          <title>Print Vaccination Records</title>
          <style>
            body { font-family: 'Inter', sans-serif; padding: 20px; background: #fff; }
            table { width: 100%; border-collapse: collapse; }
            th, td { padding: 10px; border: 1px solid #ccc; }
            .btn { display: none; }
          </style>
        </head>
        <body>
          ${section.outerHTML}
        </body>
        </html>
      `);
      printWindow.document.close();
      printWindow.focus();
      printWindow.print();
      printWindow.close();

      alert('Preparing Vaccination Records for printing...');
    }

    function downloadAllRecords() {
      const records = document.querySelector('.records-container');
      const htmlContent = `
        <html>
        <head>
          <title>All Medical Records</title>
          <style>
            body { font-family: 'Inter', sans-serif; padding: 20px; background: #fff; }
            .records-section { margin-bottom: 20px; padding: 20px; border: 1px solid #ccc; border-radius: 10px; }
            table { width: 100%; border-collapse: collapse; margin-top: 10px; }
            th, td { padding: 10px; border: 1px solid #ccc; }
            .btn { display: none; }
          </style>
        </head>
        <body>
          ${records.outerHTML}
        </body>
        </html>
      `;
      const blob = new Blob([htmlContent], { type: 'text/html' });
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = 'all_medical_records.html';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(a.href);

      alert('Downloading All Medical Records...');
    }

    function printAllRecords() {
      const records = document.querySelector('.records-container');
      const printWindow = window.open('', '', 'width=800,height=600');
      printWindow.document.write(`
        <html>
        <head>
          <title>Print All Medical Records</title>
          <style>
            body { font-family: 'Inter', sans-serif; padding: 20px; background: #fff; }
            .records-section { margin-bottom: 20px; padding: 20px; border: 1px solid #ccc; border-radius: 10px; }
            table { width: 100%; border-collapse: collapse; margin-top: 10px; }
            th, td { padding: 10px; border: 1px solid #ccc; }
            .btn { display: none; }
          </style>
        </head>
        <body>
          ${records.outerHTML}
        </body>
        </html>
      `);
      printWindow.document.close();
      printWindow.focus();
      printWindow.print();
      printWindow.close();

      alert('Preparing All Medical Records for printing...');
    }
    
    // Initialize on page load
    document.addEventListener('DOMContentLoaded', function() {
      // Check if user is logged in
      const currentUser = userManager.getCurrentUser();
      if (!currentUser) {
          // Redirect to login if no user is logged in
          window.location.href = 'index.html';
          return;
      }

      // Load patient data from localStorage
      loadPatientData();
      
      // Load visit history from completed appointments
      loadVisitHistory();
      
      // Handle mobile menu toggle if needed
      const mobileMenuToggle = document.querySelector('.mobile-menu-toggle');
      const sidebar = document.querySelector('.sidebar');
      
      if (mobileMenuToggle) {
        mobileMenuToggle.addEventListener('click', function() {
          sidebar.classList.toggle('active');
        });
      }
    });
  </script>
  
</body>
</html>
